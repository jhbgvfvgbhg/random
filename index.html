<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Pokemon Randomizer</title>
    <meta name="color-scheme" content="dark">
</head>
<body>
    <label for="rompicker">Select Pok√©mon ROM:</label>
    <input type="file" id="rompicker" accept=".gb,.sgb,.gbc,.gba,.nds">
    <p>When the app starts, find your ROM in the <code>/str/</code> folder.</p>
    <p><strong>Save your randomized ROM in the <code>/files/</code> folder.</strong></p>
    <p><button id="save">Download contents of <code>/files/</code> folder</button></p>
    <p>Tip: if the app stops working, try a <a href="https://www.howtogeek.com/672607/how-to-hard-refresh-your-web-browser-to-bypass-your-cache/" target="_blank">hard refresh</a>. Also, <strong>the app will take a long time to load</strong>, so please be patient.</p>

    <script src="https://cjrtnc.leaningtech.com/3.1/cj3loader.js"></script>
    <script>
        async function loadJAR() {
            try {
                console.log("Initializing CheerpJ...");
                await cheerpjInit();

                console.log("Fetching JAR file...");
                const response = await fetch("UPR-FVX.jar");

                if (!response.ok) {
                    throw new Error("Failed to fetch JAR file. Make sure the file exists.");
                }

                const jarData = await response.arrayBuffer();
                const jarArray = new Uint8Array(jarData);

                console.log("Mounting JAR file...");
                cheerpjAddStringFile("/app/UPR-FVX.jar", jarArray);

                console.log("Running the JAR file...");
                await cheerpjRunJar("/app/UPR-FVX.jar");

                console.log("JAR file execution started successfully.");
            } catch (error) {
                console.error("Error loading JAR:", error);
            }
        }

        window.onload = loadJAR;
    </script>
</body>
</html>
